<% layout("/layouts/boilerplate") -%>
<div class="row justify-content-center my-5">
  <div class="col-md-6 col-lg-5">
    <div class="card shadow-lg border-0 rounded">
      <div class="card-body p-4">
        <h1 class="text-center mb-4 display-6" style="color: black; font-weight: bold;">Log In</h1>
        <form action="/login" method="POST" class="needs-validation" novalidate>
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input name="email" id="email" placeholder="Enter your email" type="email" class="form-control form-control-lg rounded-pill" required>
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              Please enter a valid email.
            </div>
          </div>

          <div class="mb-3">
            <label for="password" class="form-label">Password</label>
            <div class="position-relative">
              <input name="password" id="password" placeholder="Enter your password" type="password" class="form-control form-control-lg rounded-pill" required>
              <button type="button" id="togglePassword" class="btn btn-link position-absolute end-0 top-0 mt-2 me-3" style="color: black;">
                <i class="fas fa-eye"></i>
              </button>
              <div class="valid-feedback">
                Looks good!
              </div>
              <div class="invalid-feedback">
                Please enter a valid password.
              </div>
            </div>
          </div>

          <button type="submit" class="btn btn-success w-100 btn-lg rounded-pill mt-3">Log In</button>
        </form>
        <p class="text-center mt-4">
          Don't have an account? <a href="/signup" class="text-decoration-none">Sign Up</a>
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap form validation and password toggle script -->
<script>
  // Form validation
  (function () {
    'use strict';
    var forms = document.querySelectorAll('.needs-validation');
    Array.prototype.slice.call(forms).forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  })();

  // Password visibility toggle
  const togglePassword = document.querySelector("#togglePassword");
  const passwordField = document.querySelector("#password");

  togglePassword.addEventListener("click", function () {
    // Toggle the type attribute
    const type = passwordField.getAttribute("type") === "password" ? "text" : "password";
    passwordField.setAttribute("type", type);
    
    // Toggle the eye icon
    this.querySelector("i").classList.toggle("fa-eye");
    this.querySelector("i").classList.toggle("fa-eye-slash");
  });
</script>
